# KLayout FIB Tool 调试计划

## 1. 项目分析

### 核心功能
- 创建3种FIB标记：CUT（切割）、CONNECT（连接）、PROBE（探测）
- XML格式保存/加载标记
- HTML报告生成
- 快捷键 `Ctrl+Shift+F` 启动

### 项目结构
```
src/
├── __init__.py         # 插件注册入口
├── plugin.py           # 核心逻辑（鼠标事件）
├── markers.py          # 3种标记类实现
├── storage.py          # XML序列化/反序列化
├── ui.py               # Qt界面实现
├── report.py           # HTML报告生成
├── config.py           # 配置管理
└── test_markers.py     # 测试脚本
```

## 2. 调试步骤

### 步骤1：检查当前安装状态
1. 检查KLayout插件目录结构
2. 查看是否已有fib_tool相关文件
3. 检查KLayout版本

### 步骤2：设置开发环境
1. 选择安装方式：
   - 开发模式（推荐）：创建符号链接便于实时调试
   - 手动复制：适合稳定版本使用
2. 验证安装是否成功

### 步骤3：运行测试脚本
1. 打开KLayout Macro Development窗口
2. 加载并运行test_markers.py
3. 查看测试结果和错误信息

### 步骤4：启动插件并测试功能
1. 打开一个GDS文件
2. 按`Ctrl+Shift+F`启动FIB Tool
3. 测试创建各种标记
4. 测试保存/加载功能
5. 测试HTML报告生成

### 步骤5：调试常见问题
1. 插件加载失败
2. 标记不显示
3. 鼠标点击无响应
4. 保存/加载错误

## 3. 调试工具和方法

### KLayout内置调试工具
- **Macro Development窗口**：运行和调试Python脚本
- **Messages窗口**：查看错误日志和打印信息
- **Layer Panel**：检查标记图层是否可见
- **View菜单**：调整视图缩放和显示设置

### 代码调试技巧
- 在关键位置添加`print()`语句
- 使用`pya.MessageBox.info()`显示调试信息
- 检查文件路径和权限
- 验证导入语句和模块依赖

## 4. 预期结果

- 成功安装并加载FIB Tool插件
- 能够通过快捷键或菜单启动工具
- 能够在版图上创建各种FIB标记
- 能够保存和加载标记
- 能够生成HTML报告
- 识别并解决常见问题

## 5. 后续优化建议

- 添加更详细的错误处理
- 增强调试日志
- 优化用户界面反馈
- 添加撤销/重做功能
- 支持更多标记类型

通过以上步骤，我们可以全面了解和调试KLayout FIB Tool插件，确保其正常工作并解决可能遇到的问题。